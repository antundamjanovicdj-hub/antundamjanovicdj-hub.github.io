<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>LifeKompas</title>

  <link rel="manifest" href="manifest-v2.json?v=2" />
  <link rel="icon" href="icon-192.png">
  <link rel="apple-touch-icon" href="icon-192.png">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="LifeKompas">
  <meta name="theme-color" content="#0d5e32">

  <link rel="stylesheet" href="styles/main.css">
</head>

<body>

<div class="app">

  <!-- LANGUAGE SCREEN â€” ZAKRIVLJENI CAVEAT NASLOVI -->
<div id="screen-lang" class="screen active">
  <div class="lang-circle-container">
    <svg width="280" height="280" viewBox="0 0 280 280" class="lang-svg">
      <defs>
        <path id="topArc" d="M 40,80 A 120,120 0 0 1 240,80" fill="none" />
        <path id="bottomArc" d="M 240,200 A 120,120 0 0 1 40,200" fill="none" />
        <style>@import url('https://fonts.googleapis.com/css2?family=Caveat:wght@700');</style>
      </defs>
      <text font-family="'Caveat', cursive" font-weight="700" font-size="36" fill="#0d3b25">
        <textPath href="#topArc" startOffset="50%" text-anchor="middle">LIFE</textPath>
      </text>
      <text font-family="'Caveat', cursive" font-weight="700" font-size="36" fill="#0d3b25">
        <textPath href="#bottomArc" startOffset="50%" text-anchor="middle">KOMPAS</textPath>
      </text>
    </svg>

    <!-- GUMBOVI I DALJE VAN SVG-A (da bi JS radio!) -->
    <div class="lang-circle">
      <button class="lang-btn" data-lang="hr">ğŸ‡­ğŸ‡·</button>
      <button class="lang-btn" data-lang="en">ğŸ‡ºğŸ‡¸</button>
      <button class="lang-btn" data-lang="de">ğŸ‡©ğŸ‡ª</button>
      <button class="lang-btn" data-lang="ru">ğŸ‡·ğŸ‡º</button>
      <button class="lang-btn" data-lang="pt">ğŸ‡µğŸ‡¹</button>
      <button class="lang-btn" data-lang="tr">ğŸ‡¹ğŸ‡·</button>
      <button class="lang-btn" data-lang="zh">ğŸ‡¨ğŸ‡³</button>
      <button class="lang-btn" data-lang="ja">ğŸ‡¯ğŸ‡µ</button>
    </div>
  </div>
</div>

  <!-- MENU -->
  <div id="screen-menu" class="screen">
    <button class="back" id="backMenu">â†</button>
    <div class="content">
      <div class="buttons">
        <button class="btn menu-btn" id="btnTasks" tabindex="-1">
          <span class="menu-icon">ğŸ§­</span>
          <span class="menu-text"></span>
        </button>
      </div>
    </div>
  </div>

  <!-- TASKS -->
  <div id="screen-tasks" class="screen">
    <button class="back" id="backTasks">â†</button>
    <div class="content scroll">
      <label id="tTitleL"></label>
      <input id="taskTitle">
      <label id="tNoteL"></label>
      <textarea id="taskNote"></textarea>
      <label id="tCatL"></label>
      <select id="taskCategory"></select>
      <label id="tDateL"></label>
      <input type="date" id="taskDate">
      <label id="tTimeL"></label>
      <input type="time" id="taskTime">
      <label id="tRemL"></label>
      <select id="taskReminder">
        <option value="0">â€”</option>
        <option value="30">30 min</option>
        <option value="60">1 h</option>
        <option value="120">2 h</option>
        <option value="1440">1 dan</option>
      </select>

      <div id="reminderHint" class="reminder-hint hidden"></div>

      <div class="calendar-box">
        <label class="calendar-label">
          <input type="checkbox" id="addToCalendar" checked>
          <span id="calendarLabel"></span>
        </label>
      </div>

      <button class="btn" id="saveTask"></button>
      <button class="btn" id="btnByDay"></button>

      <div id="taskList"></div>
      <div id="calendarInfo" class="note"></div>
    </div>
  </div>

</div> <!-- .app -->

<!-- POPUP -->
<div id="dayPopup" class="popup">
  <div class="popup-box">
    <div class="popup-header">
      <strong id="popupTitle"></strong>
      <button id="closeDayPopup">âœ•</button>
    </div>
    <label id="popupDateLabel"></label>
    <input type="date" id="popupDate">
    <div id="popupTasks"></div>
  </div>
</div>

<!-- SKRIPTOVE U REDOSLIJEDU -->
<script src="core/i18n.js"></script>
<script src="core/ui.js"></script>
<script src="modules/tasks/tasks.state.js"></script>
<script src="modules/tasks/tasks.ui.js"></script>
<script src="modules/tasks/tasks.popup.js"></script>
<script src="modules/tasks/tasks.calendar.js"></script>
<script src="modules/tasks/tasks.controller.js"></script>
<script src="core/app.js"></script>

<!-- Service Worker -->
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/service-worker.js').catch(console.warn);
    });
  }
</script>

<!-- Language Switcher â€” KONAÄŒNA VERZIJA -->
<script>
  window.languageSelected = false;

  function setLanguage(lang) {
    localStorage.setItem('userLang', lang);
    document.documentElement.setAttribute('lang', lang);
    window.languageSelected = true;

    if (typeof window.renderLanguage === 'function') {
      window.renderLanguage(lang);
      
      // âœ… UKLONI .active SA SVIH EKRANA
      document.querySelectorAll('.screen').forEach(el => {
        el.classList.remove('active');
      });
      
      // âœ… PRIKAÅ½I SAMO MENU
      document.getElementById('screen-menu').classList.add('active');
    }
  }

  document.addEventListener('DOMContentLoaded', function() {
    var buttons = document.querySelectorAll('.lang-btn');
    for (var i = 0; i < buttons.length; i++) {
      buttons[i].addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        var lang = this.getAttribute('data-lang');
        setLanguage(lang);
      });
    }
  });
</script>

</body>
</html>